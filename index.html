<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‚ºç™Œ AJCC ç¬¬ 9 ç‰ˆåˆ†æœŸè¨ˆç®—æ©Ÿ</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --success-color: #10b981;
            --bg-color: #f3f4f6;
            --card-bg: #ffffff;
            --text-color: #1f2937;
            --border-radius: 12px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            background-color: var(--card-bg);
            padding: 1.75rem;
            border-radius: var(--border-radius);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1),
                        0 4px 6px -2px rgba(0,0,0,0.05);
            width: 100%;
            max-width: 520px;
        }

        h1 {
            text-align: center;
            font-size: 1.35rem;
            color: var(--text-color);
            margin-bottom: 0.5rem;
        }

        .subtitle {
            text-align: center;
            font-size: 0.85rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        .meta {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-bottom: 1.25rem;
            line-height: 1.4;
        }

        .meta div + div {
            margin-top: 2px;
        }

        .form-group {
            margin-bottom: 1.1rem;
        }

        label {
            display: block;
            margin-bottom: 0.45rem;
            font-weight: 600;
            color: #374151;
            font-size: 0.9rem;
        }

        select,
        input[type="number"] {
            width: 100%;
            padding: 0.7rem;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 0.95rem;
            background-color: #fff;
            transition: all 0.2s;
            box-sizing: border-box;
        }

        select:focus,
        input[type="number"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37,99,235,0.1);
        }

        .helper-text {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-top: 0.25rem;
            line-height: 1.4;
        }

        .inline-group {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-top: 0.25rem;
            flex-wrap: wrap;
        }

        .result-box {
            margin-top: 1.5rem;
            padding: 1.4rem;
            background-color: #eff6ff;
            border-radius: 12px;
            text-align: left;
            border: 2px solid #bfdbfe;
            transition: all 0.25s ease;
        }

        .result-title {
            font-size: 0.78rem;
            color: #64748b;
            margin-bottom: 0.4rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        .result-stage {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary-color);
            line-height: 1.1;
            margin-bottom: 0.35rem;
        }

        .result-tnm {
            font-size: 0.9rem;
            font-weight: 600;
            color: #4b5563;
            margin-bottom: 0.25rem;
        }

        .result-desc {
            font-size: 0.8rem;
            color: #6b7280;
            line-height: 1.5;
        }

        .btn-row {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .copy-btn,
        .reset-btn {
            background-color: white;
            color: #4b5563;
            border: 1px solid #d1d5db;
            padding: 9px 16px;
            border-radius: 8px;
            font-size: 0.92rem;
            font-weight: 500;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            justify-content: center;
            width: 100%;
            box-sizing: border-box;
        }

        .copy-btn:hover,
        .reset-btn:hover {
            background-color: #f9fafb;
            border-color: #9ca3af;
            color: #111827;
        }

        .copy-btn:active,
        .reset-btn:active {
            transform: scale(0.98);
        }

        .copy-btn.copied {
            background-color: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .lang-toggle {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.8rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        .lang-toggle label {
            margin: 0;
            font-weight: 400;
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.8rem;
        }

        .note {
            margin-top: 1.25rem;
            font-size: 0.75rem;
            color: #9ca3af;
            text-align: left;
            line-height: 1.6;
        }

        @media (max-width: 400px) {
            .container {
                padding: 1.25rem;
            }
            .result-stage {
                font-size: 1.7rem;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ« è‚ºç™Œ AJCC åˆ†æœŸ (9th)</h1>
    <div class="subtitle">é©ç”¨ï¼šéå°ç´°èƒè‚ºç™Œï¼ˆNSCLCï¼‰è‡¨åºŠåˆ†æœŸ cTNM</div>

    <div class="meta">
        <div>ç‰ˆæœ¬ï¼šAJCC ç¬¬ 9 ç‰ˆï¼ˆLung Cancer Stagingï¼‰</div>
        <div>ä¸é©ç”¨ï¼šå°ç´°èƒè‚ºç™Œã€è¡“å¾Œç—…ç†åˆ†æœŸ pTNMã€è‚ºè½‰ç§»ç˜¤</div>
        <div>æœ€å¾Œæ›´æ–°ï¼š2025-11-26</div>
    </div>

    <div class="form-group">
        <label for="tumor-size">è…«ç˜¤æœ€å¤§å¾‘ï¼ˆcmï¼Œé¸å¡«ï¼‰</label>
        <input
            id="tumor-size"
            type="number"
            min="0"
            step="0.1"
            placeholder="ä¾‹å¦‚ï¼š3.4"
        />
        <div class="helper-text">
            å°‡ä¾å¤§å°è‡ªå‹•æ¨ä¼° T æœŸï¼ˆåƒ…è€ƒæ…®è…«ç˜¤å¾‘é•·ï¼Œæœªç´å…¥ç¸±è†ˆä¾µçŠ¯ã€å¤šç™¼çµç¯€ç­‰ï¼Œ
            è‹¥æœ‰ä¸Šè¿°æƒ…å½¢è«‹è‡ªè¡Œèª¿æ•´ T åˆ†æœŸï¼‰ã€‚
        </div>
    </div>

    <div class="form-group">
        <label for="t-stage">Tï¼ˆåŸç™¼è…«ç˜¤ï¼‰</label>
        <select id="t-stage">
            <option value="TX">TXï¼šåŸç™¼è…«ç˜¤ç„¡æ³•è©•ä¼° / ç—°ä¸­æœ‰ç™Œç´°èƒ</option>
            <option value="Tis">Tisï¼šåŸä½ç™Œ (Carcinoma in situ)</option>
            <option value="T1mi">T1miï¼šå¾®ä¾µçŠ¯è…ºç™Œ (Minimally invasive)</option>
            <option value="T1a">T1aï¼šâ‰¤ 1 cm</option>
            <option value="T1b">T1bï¼š> 1 cm ä¸” â‰¤ 2 cm</option>
            <option value="T1c">T1cï¼š> 2 cm ä¸” â‰¤ 3 cm</option>
            <option value="T2a">T2aï¼š> 3 cm ä¸” â‰¤ 4 cm</option>
            <option value="T2b">T2bï¼š> 4 cm ä¸” â‰¤ 5 cm</option>
            <option value="T3">T3ï¼š> 5 cm ä¸” â‰¤ 7 cm / ä¾µçŠ¯ç‰¹å®šçµæ§‹</option>
            <option value="T4">T4ï¼š> 7 cm / ä¾µçŠ¯ç¸±è†ˆç­‰é‡è¦çµæ§‹</option>
        </select>
    </div>

    <div class="form-group">
        <label for="n-stage">Nï¼ˆå€åŸŸæ·‹å·´çµï¼‰</label>
        <select id="n-stage">
            <option value="N0">N0ï¼šç„¡æ·‹å·´è½‰ç§»</option>
            <option value="N1">N1ï¼šåŒå´æ”¯æ°£ç®¡å‘¨åœ / è‚ºé–€</option>
            <option value="N2a">N2aï¼šå–®ä¸€ç«™åŒå´ç¸±è†ˆ / éš†çªä¸‹</option>
            <option value="N2b">N2bï¼šå¤šç«™åŒå´ç¸±è†ˆ / éš†çªä¸‹</option>
            <option value="N3">N3ï¼šå°å´ç¸±è†ˆ / å°å´è‚ºé–€ / é–éª¨ä¸Š</option>
        </select>
    </div>

    <div class="form-group">
        <label for="m-stage">Mï¼ˆé ç«¯è½‰ç§»ï¼‰</label>
        <select id="m-stage">
            <option value="M0">M0ï¼šç„¡é ç«¯è½‰ç§»</option>
            <option value="M1a">M1aï¼šå°å´è‚ºè‘‰ / èƒ¸è†œ / å¿ƒåŒ…è†œçµç¯€</option>
            <option value="M1b">M1bï¼šå–®ä¸€èƒ¸è…”å¤–è½‰ç§»</option>
            <option value="M1c1">M1c1ï¼šå¤šè™•èƒ¸è…”å¤–è½‰ç§»ï¼ˆå–®ä¸€å™¨å®˜ï¼‰</option>
            <option value="M1c2">M1c2ï¼šå¤šè™•èƒ¸è…”å¤–è½‰ç§»ï¼ˆå¤šå™¨å®˜ï¼‰</option>
        </select>
    </div>

    <div class="result-box" id="result-container">
        <div class="result-title">åˆ†æœŸçµæœï¼ˆAJCC 9thï¼‰</div>
        <div class="result-stage" id="resultStage">Occult Carcinoma</div>
        <div class="result-tnm" id="resultTNM">TNMï¼šcTX N0 M0</div>
        <div class="result-desc" id="resultDesc">
            ä»¥ç—°ç´°èƒå­¸ç™¼ç¾ç™Œç´°èƒï¼Œä½†å½±åƒå­¸æœªè¦‹æ˜ç¢ºåŸç™¼è…«ç˜¤ï¼ˆéš±åŒ¿ç™Œï¼‰ã€‚
        </div>

        <div class="btn-row">
            <button class="copy-btn" id="copyBtn">
                <span id="btnIcon">ğŸ“‹</span>
                <span id="btnText">è¤‡è£½çµæœ</span>
            </button>
            <button class="reset-btn" id="resetBtn">
                ğŸ”„ é‡è¨­æ‰€æœ‰æ¬„ä½
            </button>
        </div>

        <div class="lang-toggle">
            <span>è¤‡è£½èªè¨€ï¼š</span>
            <label>
                <input type="radio" name="copyLang" value="zh" checked>
                ä¸­æ–‡
            </label>
            <label>
                <input type="radio" name="copyLang" value="en">
                English
            </label>
        </div>
    </div>

    <div class="note">
        æœ¬å·¥å…·åƒ…ä¾›æ•™å­¸èˆ‡è¨“ç·´ä½¿ç”¨ï¼Œä¸æ§‹æˆé†«ç™‚å»ºè­°æˆ–æ­£å¼è¨ºæ–·åˆ†æœŸã€‚<br>
        å¯¦éš›åˆ†æœŸèˆ‡æ²»ç™‚æ±ºç­–ï¼Œæ‡‰ç”±è‚ºç™Œå°ˆç§‘é†«å¸«èˆ‡å¤šå°ˆæ¥­åœ˜éšŠï¼Œ
        ä¾ç—…äººå®Œæ•´è‡¨åºŠè³‡è¨Šèˆ‡ AJCC æ­£å¼æŒ‡å¼•å…±åŒåˆ¤æ–·ã€‚
    </div>
</div>

<script>
    const tSelect = document.getElementById('t-stage');
    const nSelect = document.getElementById('n-stage');
    const mSelect = document.getElementById('m-stage');
    const sizeInput = document.getElementById('tumor-size');

    const resultStageEl = document.getElementById('resultStage');
    const resultTNMEl = document.getElementById('resultTNM');
    const resultDescEl = document.getElementById('resultDesc');
    const resultBoxEl = document.getElementById('result-container');

    const copyBtn = document.getElementById('copyBtn');
    const resetBtn = document.getElementById('resetBtn');
    const btnText = document.getElementById('btnText');
    const btnIcon = document.getElementById('btnIcon');

    const t1_group = ['T1mi', 'T1a', 'T1b', 'T1c'];
    const t2_group = ['T2a', 'T2b'];
    const t1_t2_group = t1_group.concat(t2_group);

    function determineStage(t, n, m) {
        // å…ˆä¾ M æ±ºå®šæ˜¯å¦ç‚º IV æœŸ
        if (m === 'M1c1' || m === 'M1c2') {
            return { stage: 'Stage IVB', valid: true };
        }
        if (m === 'M1a' || m === 'M1b') {
            return { stage: 'Stage IVA', valid: true };
        }
        if (m !== 'M0') {
            return {
                stage: 'ç„¡å°æ‡‰åˆ†æœŸ',
                valid: false
            };
        }

        // ä»¥ä¸‹ç‚º M0 æ™‚ä¾ T/N çµ„åˆ
        if (n === 'N3') {
            if (t === 'T3' || t === 'T4') {
                return { stage: 'Stage IIIC', valid: true };
            }
            if (t1_t2_group.includes(t)) {
                return { stage: 'Stage IIIB', valid: true };
            }
            return { stage: 'ç„¡å°æ‡‰åˆ†æœŸ', valid: false };
        }

        if (n === 'N2b') {
            if (t === 'T4') {
                return { stage: 'Stage IIIB', valid: true };
            }
            if (t === 'T3' || t2_group.includes(t)) {
                return { stage: 'Stage IIIB', valid: true };
            }
            if (t1_group.includes(t)) {
                return { stage: 'Stage IIIA', valid: true };
            }
            return { stage: 'ç„¡å°æ‡‰åˆ†æœŸ', valid: false };
        }

        if (n === 'N2a') {
            if (t === 'T4') {
                return { stage: 'Stage IIIB', valid: true };
            }
            if (t === 'T3' || t2_group.includes(t)) {
                return { stage: 'Stage IIIA', valid: true };
            }
            if (t1_group.includes(t)) {
                return { stage: 'Stage IIB', valid: true };
            }
            return { stage: 'ç„¡å°æ‡‰åˆ†æœŸ', valid: false };
        }

        if (n === 'N1') {
            if (t === 'T3' || t === 'T4') {
                return { stage: 'Stage IIIA', valid: true };
            }
            if (t2_group.includes(t)) {
                return { stage: 'Stage IIB', valid: true };
            }
            if (t1_group.includes(t)) {
                return { stage: 'Stage IIA', valid: true };
            }
            return { stage: 'ç„¡å°æ‡‰åˆ†æœŸ', valid: false };
        }

        if (n === 'N0') {
            if (t === 'T4') {
                return { stage: 'Stage IIIA', valid: true };
            }
            if (t === 'T3') {
                return { stage: 'Stage IIB', valid: true };
            }
            if (t === 'T2b') {
                return { stage: 'Stage IIA', valid: true };
            }
            if (t === 'T2a') {
                return { stage: 'Stage IB', valid: true };
            }
            if (t === 'T1c') {
                return { stage: 'Stage IA3', valid: true };
            }
            if (t === 'T1b') {
                return { stage: 'Stage IA2', valid: true };
            }
            if (t === 'T1mi' || t === 'T1a') {
                return { stage: 'Stage IA1', valid: true };
            }
            if (t === 'Tis') {
                return { stage: 'Stage 0', valid: true };
            }
            if (t === 'TX') {
                return { stage: 'Occult Carcinoma', valid: true };
            }
            return { stage: 'ç„¡å°æ‡‰åˆ†æœŸ', valid: false };
        }

        return { stage: 'ç„¡å°æ‡‰åˆ†æœŸ', valid: false };
    }

    function getStageDescription(stageText) {
        if (stageText === 'Occult Carcinoma') {
            return 'ä»¥ç—°ç´°èƒå­¸ç­‰ç™¼ç¾ç™Œç´°èƒï¼Œä½†å½±åƒå­¸æœªè¦‹æ˜ç¢ºåŸç™¼è…«ç˜¤ï¼ˆéš±åŒ¿ç™Œï¼‰ã€‚';
        }
        if (stageText === 'Stage 0') {
            return 'åŸä½ç™Œï¼Œå±€é™æ–¼ä¸Šçš®å±¤ï¼Œå°šæœªä¾µçŠ¯åŸºåº•è†œï¼Œå±¬æœ€æ—©æœŸç—…è®Šã€‚';
        }
        if (stageText.startsWith('Stage IA')) {
            return 'å±€é™æ–¼è‚ºå…§å°è…«ç˜¤ï¼Œç„¡æ·‹å·´çµæˆ–é ç«¯è½‰ç§»ï¼Œé å¾Œç›¸å°è¼ƒä½³ã€‚';
        }
        if (stageText === 'Stage IB') {
            return 'è…«ç˜¤ç¨å¤§ä½†ä»å±€é™æ–¼è‚ºéƒ¨ï¼Œç„¡æ·‹å·´çµæˆ–é ç«¯è½‰ç§»ã€‚';
        }
        if (stageText.startsWith('Stage II')) {
            return 'å±€éƒ¨é€²å±•æœŸï¼Œå¯èƒ½ç´¯åŠé„°è¿‘çµæ§‹æˆ–åŒå´è‚ºé–€æ·‹å·´çµã€‚';
        }
        if (stageText.startsWith('Stage III')) {
            return 'å€åŸŸé€²å±•æœŸï¼Œå¸¸ç´¯åŠç¸±è†ˆæˆ–å¤šç«™æ·‹å·´çµï¼Œéœ€å¤šæ¨¡å¼æ²»ç™‚è©•ä¼°ã€‚';
        }
        if (stageText.startsWith('Stage IV')) {
            return 'é ç«¯è½‰ç§»æœŸï¼Œä»£è¡¨å­˜åœ¨èƒ¸è…”å¤–æˆ–å¤šè™•è½‰ç§»ï¼Œä»¥å…¨èº«æ€§æ²»ç™‚ç‚ºä¸»ã€‚';
        }
        if (stageText.includes('ç„¡å°æ‡‰åˆ†æœŸ')) {
            return 'æ­¤ T / N / M çµ„åˆä¸åœ¨ AJCC ç¬¬ 9 ç‰ˆæ¨™æº–åˆ†æœŸè¡¨ä¸­ï¼Œè«‹æª¢æŸ¥è¼¸å…¥æ˜¯å¦æ­£ç¢ºï¼Œæˆ–åƒè€ƒåŸæ–‡æŒ‡å¼•ã€‚';
        }
        return 'è«‹æ­é… AJCC ç¬¬ 9 ç‰ˆæ­£å¼æŒ‡å¼•èˆ‡è‡¨åºŠè©•ä¼°è§£è®€æ­¤åˆ†æœŸçµæœã€‚';
    }

    function updateResultAppearance(stageText, valid) {
        let category = 'early';

        if (!valid || stageText.includes('ç„¡å°æ‡‰åˆ†æœŸ')) {
            category = 'invalid';
        } else if (stageText.startsWith('Stage IV')) {
            category = 'iv';
        } else if (stageText.startsWith('Stage III')) {
            category = 'iii';
        } else if (stageText.startsWith('Stage II')) {
            category = 'ii';
        } else {
            category = 'early';
        }

        if (category === 'iv') {
            resultStageEl.style.color = '#dc2626';
            resultBoxEl.style.borderColor = '#fecaca';
            resultBoxEl.style.backgroundColor = '#fef2f2';
        } else if (category === 'iii') {
            resultStageEl.style.color = '#ea580c';
            resultBoxEl.style.borderColor = '#fed7aa';
            resultBoxEl.style.backgroundColor = '#fff7ed';
        } else if (category === 'ii') {
            resultStageEl.style.color = '#d97706';
            resultBoxEl.style.borderColor = '#fde68a';
            resultBoxEl.style.backgroundColor = '#fffbeb';
        } else if (category === 'invalid') {
            resultStageEl.style.color = '#b91c1c';
            resultBoxEl.style.borderColor = '#fecaca';
            resultBoxEl.style.backgroundColor = '#fef2f2';
        } else {
            resultStageEl.style.color = '#2563eb';
            resultBoxEl.style.borderColor = '#bfdbfe';
            resultBoxEl.style.backgroundColor = '#eff6ff';
        }
    }

    function calculateStageAndUpdateUI() {
        const t = tSelect.value;
        const n = nSelect.value;
        const m = mSelect.value;

        const { stage, valid } = determineStage(t, n, m);

        // Reset copy button state
        resetCopyButton();

        // æ›´æ–°æ–‡å­—
        resultStageEl.innerText = stage;
        const tnmText = `TNMï¼šc${t} ${n} ${m}`;
        resultTNMEl.innerText = tnmText;
        resultDescEl.innerText = getStageDescription(stage);

        // æ›´æ–°é¡è‰²
        updateResultAppearance(stage, valid);
    }

    function updateTBySize() {
        const sizeVal = parseFloat(sizeInput.value);
        if (isNaN(sizeVal) || sizeVal < 0) {
            return;
        }

        let tVal = tSelect.value;

        if (sizeVal <= 1) {
            tVal = 'T1a';
        } else if (sizeVal <= 2) {
            tVal = 'T1b';
        } else if (sizeVal <= 3) {
            tVal = 'T1c';
        } else if (sizeVal <= 4) {
            tVal = 'T2a';
        } else if (sizeVal <= 5) {
            tVal = 'T2b';
        } else if (sizeVal <= 7) {
            tVal = 'T3';
        } else {
            tVal = 'T4';
        }

        tSelect.value = tVal;
        calculateStageAndUpdateUI();
    }

    function getSelectedCopyLang() {
        const radios = document.querySelectorAll('input[name="copyLang"]');
        for (const r of radios) {
            if (r.checked) return r.value;
        }
        return 'zh';
    }

    function copyToClipboard() {
        const t = tSelect.value;
        const n = nSelect.value;
        const m = mSelect.value;
        const stageText = resultStageEl.innerText;
        const lang = getSelectedCopyLang();

        let textToCopy = '';

        if (lang === 'zh') {
            textToCopy =
                `è‚ºç™Œ AJCC ç¬¬ 9 ç‰ˆåˆ†æœŸï¼š\n` +
                `TNMï¼šc${t} ${n} ${m}\n` +
                `æœŸåˆ¥ï¼š${stageText}\n` +
                `ï¼ˆåƒ…ä¾›æ•™å­¸åƒè€ƒï¼Œå¯¦éš›ä»ä»¥è‡¨åºŠé†«å¸«èˆ‡æ­£å¼æŒ‡å¼•ç‚ºæº–ï¼‰`;
        } else {
            textToCopy =
                `Lung Cancer AJCC 9th Staging\n` +
                `TNM: c${t} ${n} ${m}\n` +
                `Stage: ${stageText}\n` +
                `For educational use only; not for clinical decision making.`;
        }

        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(textToCopy).then(
                () => handleCopySuccess(),
                () => fallbackCopy(textToCopy)
            );
        } else {
            fallbackCopy(textToCopy);
        }
    }

    function fallbackCopy(text) {
        try {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.top = '-1000px';
            textArea.style.left = '-1000px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            const successful = document.execCommand('copy');
            document.body.removeChild(textArea);

            if (successful) {
                handleCopySuccess();
            } else {
                alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•é¸å–æ–‡å­—è¤‡è£½ã€‚');
            }
        } catch (e) {
            alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•é¸å–æ–‡å­—è¤‡è£½ã€‚');
        }
    }

    function handleCopySuccess() {
        copyBtn.classList.add('copied');
        btnText.innerText = 'å·²è¤‡è£½ï¼';
        btnIcon.innerText = 'âœ…';

        setTimeout(() => {
            resetCopyButton();
        }, 2000);
    }

    function resetCopyButton() {
        copyBtn.classList.remove('copied');
        btnText.innerText = 'è¤‡è£½çµæœ';
        btnIcon.innerText = 'ğŸ“‹';
    }

    function resetAllFields() {
        sizeInput.value = '';
        tSelect.value = 'TX';
        nSelect.value = 'N0';
        mSelect.value = 'M0';

        const radios = document.querySelectorAll('input[name="copyLang"]');
        radios.forEach(r => {
            r.checked = (r.value === 'zh');
        });

        resetCopyButton();
        calculateStageAndUpdateUI();
    }

    document.addEventListener('DOMContentLoaded', () => {
        tSelect.addEventListener('change', calculateStageAndUpdateUI);
        nSelect.addEventListener('change', calculateStageAndUpdateUI);
        mSelect.addEventListener('change', calculateStageAndUpdateUI);
        sizeInput.addEventListener('input', updateTBySize);

        copyBtn.addEventListener('click', copyToClipboard);
        resetBtn.addEventListener('click', resetAllFields);

        calculateStageAndUpdateUI();
    });
</script>

</body>
</html>
